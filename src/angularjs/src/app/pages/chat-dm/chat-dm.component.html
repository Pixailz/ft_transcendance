<div class="side-bar">
	<div *ngIf="isCreatingRoom" class="popup">
		<ul class="friend-list">
			<li *ngFor="let friend of chatDmService.getFriends();">
				<button *ngIf="friend.room.id !== -1" (click)="onCreateDm(friend)">{{userService.getUserInfoFormated(friend.user_info)}}</button>
			</li>
			<button class="close" (click)="onClosePopup()">
				<mat-icon fontIcon="close"></mat-icon>
			</button>
		</ul>
	</div>
	<ul class="room-list">
		<li *ngFor="let friend of chatDmService.getFriendsRoom();">
			<button (click)="onSelectFriend(friend)">
				{{userService.getUserInfoFormated(friend.user_info)}}
			</button>
		</li>
	</ul>
	<app-flat-button bgColor="#a7dca3" fontIcon="add" (click)="onCreatingRoom()"></app-flat-button>
</div>

<div *ngIf="chatDmService.isGoodSelectedRoom()" class="chat-container">
	<h2 routerLink="/profile/{{chatDmService.getSelectedDm().user_info.ftLogin}}">{{userService.getUserInfoFormated(chatDmService.getSelectedDm().user_info)}}</h2>

	<ol class="msg-list">
		<li *ngFor="let _ of chatDmService.getSelectedDm().room.message; let i=index;" [ngClass]="{'me': getCurrentMessage(i).userId === userService.user.id, 'same': isSameUser(i)}">
			<div class="title-line">
				<span class="date" *ngIf="!isFollowingDay(i)">{{getCurrentMessage(i).updateAt | date: 'dd/MM/YYYY'}}</span>
				<span class="login" *ngIf="!isSameUser(i)">{{getCurrentMessageUser(i).ftLogin}}</span>
			</div>
			<div class="msg-line">
				<span class="content">{{getCurrentMessage(i).content}}</span>
				<span class="time">{{getCurrentMessage(i).updateAt | date: 'HH:mm'}}</span>
			</div>
		</li>
	</ol>
	<div class="txt-bar">
		<input [(ngModel)]="message" type="text" placeholder="Enter a message..." (keypress)="onPress($event)">
		<button (click)="sendMessage()">
			<mat-icon fontIcon="send"></mat-icon>
		</button>
	</div>
</div>
<app-flat-button class="refresh" bgColor="#ffb1b1" fontIcon="refresh" (click)="onGetInfo()"></app-flat-button>
